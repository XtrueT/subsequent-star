---
import ActiveLink from "@components/ActiveLink.astro";
import Search from "./Search.astro";
import { config } from "@config";
---

<div id="navbar" class="bg-inherit text-inherit">
  <nav
    id="nav"
    class="flex flex-row justify-between items-center max-sm:flex-col max-sm:justify-start bg-inherit text-inherit w-full shadow-sm h-16 max-sm:h-28"
  >
    <div class="flex justify-between items-center max-sm:w-full">
      <div class="flex justify-start items-center w-1/3 max-sm:w-1/4">
        <li class="nav-link">
          <ActiveLink href={config.url} target={"_blank"}>
            <img
              src={config.avatar}
              alt={config.author}
              class="size-10 rounded-full"
            />
            <span class="ml-3">{config.author}</span>
          </ActiveLink>
        </li>
      </div>

      <ul class="flex flex-row justify-around items-center w-2/3 max-sm:w-3/4">
        {
          config.nav.map((item) => (
            <li class="nav-link">
              <ActiveLink href={item.href}>{item.title}</ActiveLink>
            </li>
          ))
        }
      </ul>
    </div>
    <div class="w-1/3 max-sm:w-full">
      <Search />
    </div>
  </nav>
</div>

<script lang="javascript">
  // 监听滚动事件
  window.addEventListener("scroll", function () {
    const navbar = document.querySelector("#navbar");
    const headerImgBottom = document
      .querySelector("#header-img")
      .getBoundingClientRect().bottom;
    navbar.classList.toggle("fixed-nav", headerImgBottom <= -128);
  });
</script>

<style>
  .nav-link {
    @apply flex justify-center items-center w-24 h-14;
  }

  .nav-link a {
    @apply flex justify-center items-center w-full h-full mx-2  py-1 
     border-b-4 border-transparent transition-all  ease-in-out
    hover:text-gray-500 hover:border-gray-500
    dark:hover:text-gray-50;
  }
  .nav-link a.active {
    @apply border-gray-500;
  }
  .fixed-nav {
    @apply w-screen fixed top-0 left-0 z-10 px-3 lg:px-64  transition-all ease-in-out;
    margin-right: calc(100% - 100vw);
  }
</style>
