---
import { config } from "../consts";
import NavLink from "./NavLink.astro";
import Search from "./Search.astro";
---

<header class="flex flex-col justify-between bg-inherit text-inherit w-full ">
  <div
    id="header-img"
    class="relative bg-cover h-48"
    style=`background-image: url(${config.header});`
  >
    <div
      class="absolute top-0 right-0 w-full h-[inherit] opacity-50
					text-gray-50 bg-gray-950"
    >
    </div>
  </div>

  <div id="navbar" class="bg-inherit text-inherit">
    <nav
      id="nav"
      class="flex flex-row justify-between items-center max-sm:flex-col max-sm:justify-start bg-inherit text-inherit w-full shadow-sm h-16 max-sm:h-28"
    >
      <div class="flex justify-between items-center max-sm:w-full">
        <div class="flex justify-start items-center w-1/3 max-sm:w-1/4">
          <NavLink href={config.url} target={"_blank"}>
            <img
              src={config.avatar}
              alt={config.author}
              class="size-10 rounded-full"
            />
            <span class="ml-3">{config.author}</span>
          </NavLink>
        </div>

        <ul
          class="flex flex-row justify-around items-center w-2/3 max-sm:w-3/4"
        >
          {
            config.nav.map((item) => (
              <NavLink href={item.href}>{item.title}</NavLink>
            ))
          }
        </ul>
      </div>
      <div class="w-1/3 max-sm:w-full">
        <Search />
      </div>
    </nav>
  </div>
</header>
<script lang="javascript">
  // 监听滚动事件
  window.addEventListener("scroll", function () {
    const navbar = document.querySelector("#navbar");
    const headerImgBottom = document
      .querySelector("#header-img")
      .getBoundingClientRect().bottom;
    navbar.classList.toggle("fixed-nav", headerImgBottom <= -128);
  });
</script>
<style>
  .fixed-nav {
    @apply w-screen fixed top-0 left-0 z-10 px-3 lg:px-36  transition-all ease-in-out;
  }
</style>
