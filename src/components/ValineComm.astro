---
import SectionItem from "./SectionItem.astro";

const { valine } = Astro.props;
---

<SectionItem title="欢迎留言">
  <div id="valine" class="flex-grow" data-config={JSON.stringify(valine)}></div>
</SectionItem>

<script is:inline src={valine.src}></script>
<script is:inline>
  // Use import
  //   import Valine from "valine";
  document.addEventListener(
    "astro:page-load",
    function () {
      const dataset = document.getElementById("valine")?.dataset;
      const valine = dataset?.config ? JSON.parse(dataset.config) : "";
      new Valine({
        appId: valine.appId,
        appKey: valine.appKey,
        avatar: valine.avatar,
        placeholder: valine.placeholder,
        highlight: valine.highlight,
        avatarForce: valine.avatarForce,
        visitor: valine.visitor,
        recordIP: valine.recordIP,
        el: "#valine",
      });
    },
    { once: true }
  );
</script>
